
import openai
import requests
import os
from typing import Dict

class RealAIMedicalChat:
    def __init__(self):
        self.setup_apis()
    
    def setup_apis(self):
        """ุฅุนุฏุงุฏ APIs ุงูุฐูุงุก ุงูุงุตุทูุงุนู"""
        # ุฌุฑุจ ุจุฏูู API key ุฃููุงู ุจุงุณุชุฎุฏุงู ุงููููุฐุฌ ุงููุญูู
        self.apis = {
            "openai": None,  # ุณูุณุชุฎุฏู ูููุฐุฌ ูุญูู ุฃููุงู
        }
        print("โ ุชู ุชุญููู ุงูููุชุจุงุช ุจูุฌุงุญ!")
    
    def get_chatgpt_response(self, user_input: str) -> Dict:
        """ุงูุญุตูู ุนูู ุฑุฏ ูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู"""
        try:
            # ุฅุฐุง ูุงู ููุงู API keyุ ุงุณุชุฎุฏู ChatGPT ุงูุญูููู
            if self.apis["openai"]:
                openai.api_key = self.apis["openai"]
                
                response = openai.ChatCompletion.create(
                    model="gpt-3.5-turbo",
                    messages=[
                        {"role": "system", "content": "ุฃูุช ูุณุงุนุฏ ุทุจู ุฐูู. ูุฏู ูุนูููุงุช ุทุจูุฉ ุฏูููุฉ ูุน ุชุญุฐูุฑุงุช ุงูุณูุงูุฉ."},
                        {"role": "user", "content": user_input}
                    ],
                    max_tokens=300
                )
                
                return {
                    "text": response.choices[0].message.content,
                    "source": "ChatGPT API",
                    "confidence": 0.95
                }
            else:
                # ุงุณุชุฎุฏุงู ุงููููุฐุฌ ุงููุญูู ุงูุฐูู
                return self.get_smart_medical_response(user_input)
                
        except Exception as e:
            print(f"โ ุฎุทุฃ ูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู: {e}")
            # ุงุณุชุฎุฏุงู ุงููููุฐุฌ ุงููุญูู ูุจุฏูู
            return self.get_smart_medical_response(user_input)
    
    def get_smart_medical_response(self, user_input: str) -> Dict:
        """ุฑุฏ ุทุจู ุฐูู ุจุงุณุชุฎุฏุงู ุงููุนุฑูุฉ ุงููุญููุฉ"""
        user_input_lower = user_input.lower()
        
        # ูุงุนุฏุฉ ูุนุฑูุฉ ุทุจูุฉ ุดุงููุฉ
        if any(word in user_input_lower for word in ['ุตุฏุงุน', 'ุฑุงุณ', 'ูุฌุน ุฑุงุณ']):
            return {
                "text": """๐ค **ูุนูููุงุช ุนู ุงูุตุฏุงุน ูุนูุงุฌู:**

๐ **ุงูุฃุฏููุฉ ุงูุดุงุฆุนุฉ:**
โข **ุจุงุฑุงุณูุชุงููู**: ูุณูู ุฃูู - 500-1000 ูุฌู ูู 4-6 ุณุงุนุงุช
โข **ุฅูุจูุจุฑูููู**: ูุถุงุฏ ุงูุชูุงุจ - 200-400 ูุฌู ูู 6-8 ุณุงุนุงุช  
โข **ุฃุณุจุฑูู**: ูุณูู - 300-600 ูุฌู ูู 4-6 ุณุงุนุงุช (ูููุจุงุฑ ููุท)

๐ **ุงูุนูุงุฌุงุช ุงูููุฒููุฉ:**
โข ุงูุฑุงุญุฉ ูู ุบุฑูุฉ ูุธููุฉ
โข ููุงุฏุงุช ุจุงุฑุฏุฉ ุนูู ุงูุฌุจูู
โข ุดุฑุจ ุงููุงุก ุจูุซุฑุฉ
โข ุชุฏููู ุงูุฑูุจุฉ ูุงููุชููู

๐จ **ุงุณุชุดุฑ ุงูุทุจูุจ ุฅุฐุง:**
โข ุงุณุชูุฑ ุงูุตุฏุงุน ุฃูุซุฑ ูู 24 ุณุงุนุฉ
โข ูุงู ุงูุฃูู ุดุฏูุฏุงู ุฌุฏุงู
โข ุตุงุญุจู ุบุซูุงู ุฃู ููุก

โ๏ธ **ุชุญุฐูุฑุงุช:**
โข ูุง ุชุชุฌุงูุฒ ุงูุฌุฑุนุงุช ุงูููุตู ุจูุง
โข ุงุณุชุดุฑ ุงูุทุจูุจ ูุจู ุงูุงุณุชุฎุฏุงู ุงููุชูุฑุฑ""",
                "source": "ุงููุณุงุนุฏ ุงูุทุจู ุงูุฐูู ๐ฉบ",
                "confidence": 0.95
            }
        
        elif any(word in user_input_lower for word in ['ุฏูุฎุฉ', 'ุฏูุงุฑ', 'ุฏูุฎุงู']):
            return {
                "text": """๐ฏ **ูุนูููุงุช ุนู ุงูุฏูุฎุฉ ูุนูุงุฌูุง:**

๐ **ุงูุฃุฏููุฉ ุงููุญุชููุฉ:**
โข **ูููููุฒูู**: ููุฏูุฎุฉ ูุงูุฏูุงุฑ - 25-50 ูุฌู ุญุณุจ ุงูุญุงุฌุฉ
โข **ุจูุชุงูุณุชูู**: ูุชุญุณูู ุงูุฏูุฑุฉ ุงูุฏูููุฉ ูู ุงูุฃุฐู

๐ **ุงูุฃุณุจุงุจ ุงูุดุงุฆุนุฉ:**
โข ุงูุฎูุงุถ ุถุบุท ุงูุฏู
โข ููุฑ ุงูุฏู (ุงูุฃููููุง) 
โข ุฌูุงู ุงูุฌุณู
โข ุงูุฎูุงุถ ุณูุฑ ุงูุฏู

๐ **ุงูุฅุณุนุงูุงุช ุงูุฃูููุฉ:**
โข ุงูุฌููุณ ุฃู ุงูุงุณุชููุงุก ููุฑุงู
โข ุดุฑุจ ุงููุงุก ุจูุซุฑุฉ
โข ุชุฌูุจ ุงูุญุฑูุงุช ุงูููุงุฌุฆุฉ
โข ุงูุชููุณ ุจุนูู ูุจุจุทุก

๐จ **ุฑุงุฌุน ุงูุทุจูุจ ุฅุฐุง:**
โข ุชูุฑุฑุช ุงูุฏูุฎุฉ frequently
โข ุตุงุญุจุชูุง ุฒุบููุฉ ูู ุงูุนูู
โข ุณุจุจุช ุณููุทุงู ุฃู ุฅุตุงุจุฉ""",
                "source": "ุงููุณุงุนุฏ ุงูุทุจู ุงูุฐูู ๐ฉบ",
                "confidence": 0.92
            }
        
        elif any(word in user_input_lower for word in ['ุณุนุงู', 'ูุญุฉ', 'ูุญู']):
            return {
                "text": """๐ฌ๏ธ **ูุนูููุงุช ุนู ุงูุณุนุงู ูุนูุงุฌู:**

๐ **ุฃููุงุน ุงูุณุนุงู ูุงูุฃุฏููุฉ:**
โข **ุงูุณุนุงู ุงูุฌุงู**: ุฏููุณุชุฑูููุซูุฑูุงู - 10-20 ูุฌู ูู 4-8 ุณุงุนุงุช
โข **ุงูุณุนุงู ุงูุฑุทุจ**: ุบูุงูููููุณูู - 200-400 ูุฌู ูู 4 ุณุงุนุงุช

๐ **ุงูุนูุงุฌุงุช ุงูุทุจูุนูุฉ:**
โข ุงูุนุณู ูุงูููููู ูู ูุงุก ุฏุงูุฆ
โข ูุดุฑูุจุงุช ุงูุฃุนุดุงุจ ุงูุฏุงูุฆุฉ
โข ุงุณุชูุดุงู ุงูุจุฎุงุฑ ุงูุฏุงูุฆ
โข ุงูุบุฑุบุฑุฉ ุจุงููุงุก ุงููุงูุญ

๐จ **ุงุณุชุดุฑ ุงูุทุจูุจ ุฅุฐุง:**
โข ุงุณุชูุฑ ุงูุณุนุงู ุฃูุซุฑ ูู 3 ุฃุณุงุจูุน
โข ุตุงุญุจู ุฏู ุฃู ุจูุบู ุฃุฎุถุฑ
โข ุณุจุจ ุถููุงู ูู ุงูุชููุณ""",
                "source": "ุงููุณุงุนุฏ ุงูุทุจู ุงูุฐูู ๐ฉบ", 
                "confidence": 0.90
            }
        
        else:
            return {
                "text": f"""๐ฉบ **ุงููุณุงุนุฏ ุงูุทุจู ุงูุฐูู**

ููุฏ ุชูููุช ุณุคุงูู: "{user_input}"

๐ **ูููููู ูุณุงุนุฏุชู ูู ูุนูููุงุช ุนู:**
โข ุฃุฏููุฉ ุงูุตุฏุงุน ูุงูุฃูู
โข ุฃุฏููุฉ ุงูุณุนุงู ูุงูุจุฑุฏ  
โข ุฃุฏููุฉ ุงูุญุณุงุณูุฉ
โข ุฃุฏููุฉ ุงููุนุฏุฉ
โข ุฎุงูุถุงุช ุงูุญุฑุงุฑุฉ

๐ก **ุฌุฑุจ ูุฐู ุงูุฃุณุฆูุฉ:**
"ุฏูุงุก ููุตุฏุงุน"
"ุนูุงุฌ ุงูุณุนุงู"
"ุฃุฏููุฉ ุงูุญุณุงุณูุฉ"

โ๏ธ **ุชุฐูุฑ:** ูุฐู ูุนูููุงุช ุงุณุชุฑุดุงุฏูุฉุ ุงุณุชุดุฑ ุงูุทุจูุจ ููุชุดุฎูุต ุงูุฏููู.""",
                "source": "ุงููุณุงุนุฏ ุงูุทุจู ุงูุฐูู ๐ฉบ",
                "confidence": 0.75
            }

# ุงุฎุชุจุงุฑ ุงููุธุงู
if __name__ == "__main__":
    print("๐งช ุจุฏุก ุงุฎุชุจุงุฑ ุงููุณุงุนุฏ ุงูุทุจู...")
    
    # ุฅูุดุงุก ุงููุณุงุนุฏ
    chat_bot = RealAIMedicalChat()
    
    # ุงุฎุชุจุงุฑ ุงูุฃุณุฆูุฉ
    test_questions = [
        "ุฏูุงุก ููุตุฏุงุน",
        "ุนูุงุฌ ุงูุฏูุฎุฉ", 
        "ูุนูููุงุช ุนู ุงูุณุนุงู",
        "ููู ุฃุชุนุงูู ูุน ุงูุญููุ"
    ]
    
    for question in test_questions:
        print(f"\n{'='*50}")
        print(f"๐งช ุงูุณุคุงู: {question}")
        print(f"{'='*50}")
        
        response = chat_bot.get_chatgpt_response(question)
        print(f"๐ค ุงูุฑุฏ: {response['text']}")
        print(f"๐ ุงููุตุฏุฑ: {response['source']}")
        print(f"๐ฏ ุงูุซูุฉ: {response['confidence']}")
